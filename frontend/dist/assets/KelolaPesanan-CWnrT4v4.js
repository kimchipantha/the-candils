import{d as F,c as $,a as g,o as m,b as e,t as u,e as P,h as y,w as Z,F as D,r as C,n as E,f as V,B as Q,s as W,T as oe,i as X,q as ee,j as A,v as K,k as Y,M as le,E as ie,G as de,C as ue,x as J,_ as pe,U as me,D as ge,V as z,W as ce,X as be}from"./index-BWtGjQtB.js";const ve={class:"mb-6 bg-white rounded-lg border border-gray-200 p-4 shadow-sm"},xe={class:"grid grid-cols-2 gap-3 sm:grid-cols-3 md:grid-cols-5"},fe={class:"flex items-start justify-between mb-3"},ke={class:"text-2xl font-bold text-gray-800 mt-1"},he={class:"flex items-start justify-between mb-3"},ye={class:"text-2xl font-bold text-gray-800 mt-1"},we={class:"flex items-start justify-between mb-3"},Pe={class:"text-2xl font-bold text-gray-800 mt-1"},$e={class:"flex items-start justify-between mb-3"},Ie={class:"text-2xl font-bold text-gray-800 mt-1"},De={class:"flex items-start justify-between mb-3"},Ce={class:"text-2xl font-bold text-gray-800 mt-1"},Me={class:"mt-4 pt-4 border-t border-gray-200 flex items-center justify-between"},Le={class:"flex items-center text-sm text-gray-600"},je={class:"text-gray-900"},Be=F({__name:"PesananSummaryCards",props:{actionCards:{}},emits:["filter-status","refresh"],setup(j){const b=j,h=$(()=>b.actionCards.perluValidasi+b.actionCards.perluDikirim+b.actionCards.dikirim+b.actionCards.selesai+b.actionCards.dibatalkan);return(v,s)=>(m(),g("div",ve,[s[24]||(s[24]=e("div",{class:"flex items-center mb-4"},[e("svg",{class:"w-5 h-5 mr-2 text-gray-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),e("span",{class:"font-semibold text-gray-900"},"Ringkasan Status Pesanan")],-1)),e("div",xe,[e("div",{class:"flex flex-col h-full bg-yellow-50 rounded-xl border border-yellow-100 p-3 hover:shadow-md transition-all duration-300 cursor-pointer group",onClick:s[0]||(s[0]=d=>v.$emit("filter-status","perlu-validasi"))},[e("div",fe,[e("div",null,[s[6]||(s[6]=e("p",{class:"text-[10px] font-bold text-yellow-600 uppercase tracking-wider"}," Perlu Validasi ",-1)),e("p",ke,u(v.actionCards.perluValidasi),1)]),s[7]||(s[7]=e("div",{class:"w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center text-yellow-600 group-hover:bg-yellow-500 group-hover:text-white transition-colors duration-300"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1))]),s[8]||(s[8]=e("div",{class:"mt-auto flex items-center text-[10px] font-medium text-yellow-700 bg-yellow-100/50 px-2 py-1 rounded-md"},[e("svg",{class:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"truncate"},"Menunggu validasi")],-1))]),e("div",{class:"flex flex-col h-full bg-blue-50 rounded-xl border border-blue-100 p-3 hover:shadow-md transition-all duration-300 cursor-pointer group",onClick:s[1]||(s[1]=d=>v.$emit("filter-status","perlu-dikirim"))},[e("div",he,[e("div",null,[s[9]||(s[9]=e("p",{class:"text-[10px] font-bold text-blue-600 uppercase tracking-wider"}," Perlu Dikirim ",-1)),e("p",ye,u(v.actionCards.perluDikirim),1)]),s[10]||(s[10]=e("div",{class:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 group-hover:bg-blue-500 group-hover:text-white transition-colors duration-300"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})])],-1))]),s[11]||(s[11]=e("div",{class:"mt-auto flex items-center text-[10px] font-medium text-blue-700 bg-blue-100/50 px-2 py-1 rounded-md"},[e("svg",{class:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})]),e("span",{class:"truncate"},"Menunggu pengemasan")],-1))]),e("div",{class:"flex flex-col h-full bg-purple-50 rounded-xl border border-purple-100 p-3 hover:shadow-md transition-all duration-300 cursor-pointer group",onClick:s[2]||(s[2]=d=>v.$emit("filter-status","dikirim"))},[e("div",we,[e("div",null,[s[12]||(s[12]=e("p",{class:"text-[10px] font-bold text-purple-600 uppercase tracking-wider"}," Dikirim ",-1)),e("p",Pe,u(v.actionCards.dikirim),1)]),s[13]||(s[13]=e("div",{class:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-purple-600 group-hover:bg-purple-500 group-hover:text-white transition-colors duration-300"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1))]),s[14]||(s[14]=e("div",{class:"mt-auto flex items-center text-[10px] font-medium text-purple-700 bg-purple-100/50 px-2 py-1 rounded-md"},[e("svg",{class:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"truncate"},"Sedang dikirim")],-1))]),e("div",{class:"flex flex-col h-full bg-green-50 rounded-xl border border-green-100 p-3 hover:shadow-md transition-all duration-300 cursor-pointer group",onClick:s[3]||(s[3]=d=>v.$emit("filter-status","selesai"))},[e("div",$e,[e("div",null,[s[15]||(s[15]=e("p",{class:"text-[10px] font-bold text-green-600 uppercase tracking-wider"}," Selesai ",-1)),e("p",Ie,u(v.actionCards.selesai),1)]),s[16]||(s[16]=e("div",{class:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600 group-hover:bg-green-500 group-hover:text-white transition-colors duration-300"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})])],-1))]),s[17]||(s[17]=e("div",{class:"mt-auto flex items-center text-[10px] font-medium text-green-700 bg-green-100/50 px-2 py-1 rounded-md"},[e("svg",{class:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"truncate"},"Berhasil selesai")],-1))]),e("div",{class:"flex flex-col h-full bg-red-50 rounded-xl border border-red-100 p-3 hover:shadow-md transition-all duration-300 cursor-pointer group",onClick:s[4]||(s[4]=d=>v.$emit("filter-status","dibatalkan"))},[e("div",De,[e("div",null,[s[18]||(s[18]=e("p",{class:"text-[10px] font-bold text-red-600 uppercase tracking-wider"}," Dibatalkan ",-1)),e("p",Ce,u(v.actionCards.dibatalkan),1)]),s[19]||(s[19]=e("div",{class:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center text-red-600 group-hover:bg-red-500 group-hover:text-white transition-colors duration-300"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})])],-1))]),s[20]||(s[20]=e("div",{class:"mt-auto flex items-center text-[10px] font-medium text-red-700 bg-red-100/50 px-2 py-1 rounded-md"},[e("svg",{class:"w-3 h-3 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("span",{class:"truncate"},"Pesanan batal")],-1))])]),e("div",Me,[e("div",Le,[s[22]||(s[22]=e("svg",{class:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),e("span",null,[s[21]||(s[21]=P("Total Pesanan: ",-1)),e("strong",je,u(h.value),1)])]),e("button",{class:"text-xs font-medium text-blue-600 hover:text-blue-800 flex items-center group",onClick:s[5]||(s[5]=d=>v.$emit("refresh"))},[...s[23]||(s[23]=[e("svg",{class:"w-4 h-4 mr-1 group-hover:rotate-180 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),P(" Refresh Data ",-1)])])])]))}}),Te={class:"mb-4 bg-white rounded-t-lg border-b border-gray-200"},Se={class:"flex space-x-1 overflow-x-auto"},_e=["onClick"],Ve={key:0,class:"ml-1 text-xs text-gray-500"},Ue={class:"bg-white border-b border-gray-200 px-4 py-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4"},Oe={class:"flex flex-col md:flex-row gap-3 w-full md:w-auto"},Ae={class:"flex items-center gap-2"},Ne=["value","max"],Re=["value","min","max"],ze=["value"],Ee={class:"flex items-center space-x-2"},Fe={class:"bg-white rounded-b-lg shadow-sm overflow-hidden"},He={class:"overflow-x-auto"},qe={class:"min-w-full divide-y divide-gray-200"},Ge={class:"bg-white divide-y divide-gray-200"},Ke={class:"px-4 py-4"},Ye={class:"text-sm font-medium text-gray-900"},Je={class:"text-xs text-gray-500"},We={class:"px-4 py-4"},Xe=["value","onChange","disabled"],Qe=["value"],Ze={class:"px-4 py-4"},et={class:"text-sm text-gray-900"},tt={class:"px-4 py-4"},at={class:"text-sm text-gray-600"},st={class:"px-4 py-4"},nt=["value","onChange","disabled"],rt=["value"],ot={class:"px-4 py-4"},lt={class:"px-4 py-4"},it={class:"text-sm font-medium text-gray-900"},dt={class:"px-4 py-4"},ut=["onClick"],pt={key:0,class:"flex flex-col sm:flex-row items-center justify-between px-4 py-3 bg-white border-t border-gray-200 sm:px-6"},mt={class:"text-sm text-gray-600 mb-4 sm:mb-0"},gt={class:"font-medium text-gray-900"},ct={class:"font-medium text-gray-900"},bt={class:"font-medium text-gray-900"},vt={class:"flex gap-2"},xt=["disabled"],ft=["disabled"],kt={key:1,class:"text-center py-12"},N=10,ht=F({__name:"PesananTable",props:{tabs:{},activeTab:{},pesananList:{},selectedOrders:{},lokasiList:{},activeFilters:{},loading:{type:Boolean,default:!1},startDate:{default:""},endDate:{default:""},tipePesananFilter:{default:"all"}},emits:["change-tab","toggle-select-all","update-selected","update-status","update-lokasi","open-detail","open-add-modal","update:startDate","update:endDate","update:tipePesananFilter"],setup(j,{emit:b}){const h=j,v=b,s=y(1),d=new Date().toISOString().split("T")[0];Z(()=>h.pesananList,()=>{s.value=1});const i=$(()=>Math.ceil(h.pesananList.length/N)),o=$(()=>{const l=(s.value-1)*N,a=l+N;return h.pesananList.slice(l,a)});$(()=>(s.value-1)*N+1),$(()=>Math.min(s.value*N,h.pesananList.length));function f(){s.value<i.value&&s.value++}function M(){s.value>1&&s.value--}$(()=>h.selectedOrders.length===h.pesananList.length&&h.pesananList.length>0);function B(l,a){if(w(l.statusPesanan))return;const t={...l,statusPesanan:a};v("update-status",t)}function T(l,a){if(w(l.statusPesanan))return;const t={...l,lokasiId:a};v("update-lokasi",t)}function w(l){return l==="Selesai"||l==="Dibatalkan"}function L(l){const a=[l];switch(l){case"Perlu Validasi":a.push("Perlu Dikirim"),a.push("Dibatalkan");break;case"Perlu Dikirim":a.push("Dikirim"),a.push("Dibatalkan");break;case"Dikirim":a.push("Selesai"),a.push("Dibatalkan");break}return[...new Set(a)]}function S(l){return new Date(l).toLocaleDateString("id-ID",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}function _(l){return new Intl.NumberFormat("id-ID").format(l)}function U(l){switch(l){case"Selesai":return"bg-green-100 text-green-800 focus:ring-green-500";case"Perlu Dikirim":return"bg-blue-100 text-blue-800 focus:ring-blue-500";case"Dikirim":return"bg-purple-100 text-purple-800 focus:ring-purple-500";case"Perlu Validasi":return"bg-yellow-100 text-yellow-800 focus:ring-yellow-500";case"Dibatalkan":return"bg-red-100 text-red-800 focus:ring-red-500";default:return"bg-gray-100 text-gray-800 focus:ring-gray-500"}}function R(l){return(l||"Online").toLowerCase().includes("offline")?"bg-pink-100 text-pink-800 border border-pink-300":"bg-indigo-100 text-indigo-800 border border-indigo-300"}return(l,a)=>(m(),g("div",null,[e("div",Te,[e("div",Se,[(m(!0),g(D,null,C(l.tabs,t=>(m(),g("button",{key:t.value,onClick:r=>l.$emit("change-tab",t.value),class:E(["px-4 py-3 text-sm font-medium whitespace-nowrap transition-colors",l.activeTab===t.value?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"])},[P(u(t.label)+" ",1),t.count>0?(m(),g("span",Ve,u(t.count),1)):V("",!0)],10,_e))),128))])]),e("div",Ue,[e("div",Oe,[e("div",Ae,[e("input",{type:"date",value:l.startDate,max:l.endDate||Q(d),onInput:a[0]||(a[0]=t=>l.$emit("update:startDate",t.target.value)),class:"border border-gray-300 rounded px-2 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dari Tanggal"},null,40,Ne),a[4]||(a[4]=e("span",{class:"text-gray-400"},"-",-1)),e("input",{type:"date",value:l.endDate,min:l.startDate,max:Q(d),onInput:a[1]||(a[1]=t=>l.$emit("update:endDate",t.target.value)),class:"border border-gray-300 rounded px-2 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Sampai Tanggal"},null,40,Re)]),e("select",{value:l.tipePesananFilter,onChange:a[2]||(a[2]=t=>l.$emit("update:tipePesananFilter",t.target.value)),class:"border border-gray-300 rounded px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},[...a[5]||(a[5]=[e("option",{value:"all"},"Semua Tipe",-1),e("option",{value:"Online"},"Online",-1),e("option",{value:"Offline"},"Offline",-1)])],40,ze)]),e("div",Ee,[e("button",{onClick:a[3]||(a[3]=t=>l.$emit("open-add-modal")),class:"flex items-center px-3 py-2 text-sm font-medium text-white bg-blue-600 border border-blue-600 rounded hover:bg-blue-700 transition-colors"},[...a[6]||(a[6]=[e("svg",{class:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),P(" Tambah Pesanan ",-1)])])])]),e("div",Fe,[e("div",He,[e("table",qe,[a[9]||(a[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," ID Pesanan "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status Pesanan "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nama Pelanggan "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Kontak "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Lokasi "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tipe "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Total "),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Aksi ")])],-1)),e("tbody",Ge,[l.loading?(m(),g(D,{key:0},C(N,t=>e("tr",{key:"skeleton-"+t,class:"animate-pulse border-b border-gray-200"},[...a[7]||(a[7]=[e("td",{class:"px-4 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded w-16 mb-2"}),e("div",{class:"h-3 bg-gray-200 rounded w-24"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-6 bg-gray-200 rounded-full w-24"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded w-32"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded w-28"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-8 bg-gray-200 rounded w-32"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-5 bg-gray-200 rounded w-16"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded w-24"})],-1),e("td",{class:"px-4 py-4"},[e("div",{class:"h-4 bg-gray-200 rounded w-20"})],-1)])])),64)):(m(!0),g(D,{key:1},C(o.value,t=>(m(),g("tr",{key:t.pesananId,class:"hover:bg-gray-50 transition-colors"},[e("td",Ke,[e("div",Ye,"#"+u(t.pesananId),1),e("div",Je,u(S(t.tanggalPesanan)),1)]),e("td",We,[e("select",{value:t.statusPesanan,onChange:r=>B(t,r.target.value),class:E(["text-xs font-medium px-3 py-1 rounded-full border-0 focus:ring-2 focus:ring-offset-2 cursor-pointer",U(t.statusPesanan),{"disabled:opacity-60 disabled:cursor-not-allowed":w(t.statusPesanan)}]),disabled:w(t.statusPesanan)},[(m(!0),g(D,null,C(L(t.statusPesanan),r=>(m(),g("option",{key:r,value:r},u(r),9,Qe))),128))],42,Xe)]),e("td",Ze,[e("div",et,u(t.namaPelanggan),1)]),e("td",tt,[e("div",at,u(t.kontakPelanggan),1)]),e("td",st,[e("select",{value:t.lokasiId,onChange:r=>T(t,Number(r.target.value)),class:E(["text-xs font-medium px-3 py-1 rounded border border-gray-300 focus:ring-2 focus:ring-blue-500 cursor-pointer",{"text-gray-500":!t.lokasiId,"disabled:opacity-60 disabled:cursor-not-allowed":w(t.statusPesanan)}]),disabled:w(t.statusPesanan)},[a[8]||(a[8]=e("option",{value:null,disabled:""},"-- Pilih Lokasi --",-1)),(m(!0),g(D,null,C(l.lokasiList,r=>(m(),g("option",{key:r.id||r.lokasiId,value:r.id||r.lokasiId},u(r.name||r.namaLokasi),9,rt))),128))],42,nt)]),e("td",ot,[e("span",{class:E([R(t.tipePesanan),"text-xs font-medium px-2 py-1 rounded"])},u(t.tipePesanan||"Online"),3)]),e("td",lt,[e("div",it," Rp "+u(_(t.totalHarga)),1)]),e("td",dt,[e("button",{onClick:r=>l.$emit("open-detail",t),class:"text-blue-600 hover:text-blue-800 text-sm font-medium"}," Lihat Detail ",8,ut)])]))),128))])])]),!l.loading&&l.pesananList.length>0?(m(),g("div",pt,[e("div",mt,[a[10]||(a[10]=P(" Menampilkan halaman ",-1)),e("span",gt,u(s.value),1),a[11]||(a[11]=P(" dari ",-1)),e("span",ct,u(i.value),1),a[12]||(a[12]=e("span",{class:"text-gray-400 mx-2"},"|",-1)),a[13]||(a[13]=P(" Total ",-1)),e("span",bt,u(l.pesananList.length),1),a[14]||(a[14]=P(" pesanan ",-1))]),e("div",vt,[e("button",{onClick:M,disabled:s.value===1,class:"px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Previous ",8,xt),e("button",{onClick:f,disabled:s.value===i.value,class:"px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Next ",8,ft)])])):V("",!0),!l.loading&&l.pesananList.length===0?(m(),g("div",kt,[...a[15]||(a[15]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Tidak ada pesanan",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Tidak ada pesanan yang sesuai dengan filter yang dipilih.",-1)])])):V("",!0)])]))}}),yt={class:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto"},wt={class:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between"},Pt={class:"text-xl font-bold text-gray-900"},$t={class:"text-sm text-gray-500 mt-1"},It={class:"p-6 space-y-6"},Dt={class:"bg-gray-50 rounded-lg p-4"},Ct={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Mt={class:"text-sm font-medium text-gray-900"},Lt={class:"text-sm font-medium text-gray-900"},jt={class:"md:col-span-2"},Bt={class:"text-sm font-medium text-gray-900"},Tt={class:"border border-gray-200 rounded-lg overflow-hidden"},St={class:"min-w-full divide-y divide-gray-200"},_t={class:"bg-white divide-y divide-gray-200"},Vt={class:"px-4 py-3 text-sm text-gray-900"},Ut={class:"px-4 py-3 text-sm text-gray-600"},Ot={class:"px-4 py-3 text-sm text-gray-900"},At={class:"px-4 py-3 text-sm text-gray-900 text-right"},Nt={class:"bg-gray-50"},Rt={key:0},zt={class:"px-4 py-3 text-sm font-medium text-gray-900 text-right"},Et={class:"px-4 py-3 text-sm font-bold text-blue-600 text-right"},Ft={class:"bg-blue-50 rounded-lg p-4"},Ht={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},qt={class:"text-sm font-medium text-gray-900"},Gt={key:0,class:"bg-gray-50 rounded-lg p-4"},Kt=["href"],Yt=["src"],Jt={key:1,class:"bg-gray-50 rounded-lg p-4"},Wt={class:"sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-between gap-3"},Xt={class:"flex items-center gap-3"},Qt={class:"flex items-center gap-3"},Zt=F({__name:"PesananDetailModal",props:{pesanan:{},lokasiList:{}},emits:["close","validateOrder","cancelOrder"],setup(j){const b=j;function h(i){return new Date(i).toLocaleDateString("id-ID",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1})}function v(i){return new Intl.NumberFormat("id-ID").format(i)}function s(i){switch(i){case"Selesai":return"bg-green-100 text-green-800";case"Perlu Dikirim":return"bg-blue-100 text-blue-800";case"Dikirim":return"bg-purple-100 text-purple-800";case"Dibatalkan":return"bg-red-100 text-red-800";default:return"bg-yellow-100 text-yellow-800"}}function d(i){if(!i)return"-- Belum ditentukan --";const o=b.lokasiList.find(f=>(f.id||f.lokasiId)===i);return o&&(o.name||o.namaLokasi)||"-- Tidak ditemukan --"}return(i,o)=>(m(),W(oe,{to:"body"},[e("div",{class:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{"background-color":"rgba(0, 0, 0, 0.7)"},onClick:o[3]||(o[3]=X(f=>i.$emit("close"),["self"]))},[e("div",yt,[e("div",wt,[e("div",null,[e("h2",Pt,"Detail Pesanan #"+u(i.pesanan.pesananId),1),e("p",$t,u(h(i.pesanan.tanggalPesanan)),1)]),e("button",{onClick:o[0]||(o[0]=f=>i.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[...o[4]||(o[4]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",It,[e("div",Dt,[o[8]||(o[8]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Informasi Pelanggan",-1)),e("div",Ct,[e("div",null,[o[5]||(o[5]=e("p",{class:"text-xs text-gray-500 mb-1"},"Nama Lengkap",-1)),e("p",Mt,u(i.pesanan.namaPelanggan),1)]),e("div",null,[o[6]||(o[6]=e("p",{class:"text-xs text-gray-500 mb-1"},"Kontak",-1)),e("p",Lt,u(i.pesanan.kontakPelanggan),1)]),e("div",jt,[o[7]||(o[7]=e("p",{class:"text-xs text-gray-500 mb-1"},"Alamat Pengiriman",-1)),e("p",Bt,u(i.pesanan.alamatPengiriman),1)])])]),e("div",null,[o[12]||(o[12]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Produk yang Dipesan",-1)),e("div",Tt,[e("table",St,[o[11]||(o[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Produk"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Ukuran"),e("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase"},"Jumlah"),e("th",{class:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase"},"Subtotal")])],-1)),e("tbody",_t,[(m(!0),g(D,null,C(i.pesanan.items||[],(f,M)=>(m(),g("tr",{key:M},[e("td",Vt,u(f.productName||f.namaProduk||"-"),1),e("td",Ut,u(f.ukuranName||f.namaUkuran||"-"),1),e("td",Ot,u(f.quantity)+"x",1),e("td",At," Rp "+u(v(f.subtotal)),1)]))),128))]),e("tfoot",Nt,[i.pesanan.biayaPemesanan?(m(),g("tr",Rt,[o[9]||(o[9]=e("td",{colspan:"3",class:"px-4 py-3 text-sm font-medium text-gray-900"},"Ongkos Kirim",-1)),e("td",zt," Rp "+u(v(i.pesanan.biayaPemesanan)),1)])):V("",!0),e("tr",null,[o[10]||(o[10]=e("td",{colspan:"3",class:"px-4 py-3 text-sm font-bold text-gray-900"},"Total",-1)),e("td",Et," Rp "+u(v(i.pesanan.totalHarga)),1)])])])])]),e("div",Ft,[o[15]||(o[15]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Status Pesanan",-1)),e("div",Ht,[e("div",null,[o[13]||(o[13]=e("p",{class:"text-xs text-gray-500 mb-1"},"Status",-1)),e("span",{class:E(["inline-block px-3 py-1 rounded-full text-xs font-medium",s(i.pesanan.statusPesanan)])},u(i.pesanan.statusPesanan),3)]),e("div",null,[o[14]||(o[14]=e("p",{class:"text-xs text-gray-500 mb-1"},"Lokasi",-1)),e("p",qt,u(d(i.pesanan.lokasiId)),1)])])]),e("div",null,[o[17]||(o[17]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Bukti Pembayaran",-1)),i.pesanan.buktiPembayaranUrl?(m(),g("div",Gt,[e("a",{href:i.pesanan.buktiPembayaranUrl,target:"_blank",rel:"noopener noreferrer",title:"Klik untuk melihat gambar penuh",class:"block w-full max-w-sm mx-auto"},[e("img",{src:i.pesanan.buktiPembayaranUrl,alt:"Bukti Pembayaran",class:"w-full h-auto rounded-md shadow-md object-cover cursor-pointer hover:opacity-80 transition-opacity"},null,8,Yt)],8,Kt)])):(m(),g("div",Jt,[...o[16]||(o[16]=[e("p",{class:"text-sm text-gray-500 text-center"}," Pelanggan belum meng-upload bukti pembayaran. ",-1)])]))])]),e("div",Wt,[e("div",Xt,[i.pesanan.statusPesanan!=="Dibatalkan"&&i.pesanan.statusPesanan!=="Selesai"?(m(),g("button",{key:0,onClick:o[1]||(o[1]=f=>i.$emit("cancelOrder",i.pesanan.pesananId)),class:"px-4 py-2 border border-red-300 rounded-lg text-red-600 hover:bg-red-50 transition-colors text-sm font-medium"}," Batalkan Pesanan ")):V("",!0)]),e("div",Qt,[i.pesanan.statusPesanan==="Perlu Validasi"?(m(),g("button",{key:0,onClick:o[2]||(o[2]=f=>i.$emit("validateOrder",i.pesanan.pesananId)),class:"px-4 py-2 border border-green-500 rounded-lg text-white bg-green-600 hover:bg-green-700 transition-colors text-sm font-medium"}," Validasi & Proses ")):V("",!0)])])])])]))}}),ea={class:"relative top-10 mx-auto p-6 w-full max-w-4xl shadow-2xl rounded-2xl bg-white mb-10 transform transition-all duration-300"},ta={class:"flex justify-between items-center pb-4 border-b-2 border-blue-100"},aa={class:"bg-gradient-to-r from-blue-50 to-indigo-50 p-5 rounded-xl border border-blue-100"},sa={class:"grid grid-cols-2 gap-4"},na={class:"mt-4"},ra=["value"],oa={class:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-100 p-5 rounded-xl"},la={class:"flex justify-between items-center mb-4"},ia={class:"bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-bold"},da={class:"space-y-3"},ua={class:"flex items-center justify-between mb-3"},pa={class:"flex items-center gap-2"},ma={class:"bg-gradient-to-r from-purple-500 to-pink-500 text-white w-7 h-7 rounded-full flex items-center justify-center text-sm font-bold"},ga={class:"text-sm font-semibold text-gray-700"},ca=["onClick","disabled"],ba={class:"grid grid-cols-12 gap-3"},va={class:"col-span-5"},xa=["onUpdate:modelValue","onChange"],fa=["value"],ka={class:"col-span-4"},ha=["onUpdate:modelValue","onChange","disabled"],ya=["value"],wa={class:"col-span-3"},Pa=["onUpdate:modelValue","onInput"],$a={class:"mt-3 pt-3 border-t border-gray-100"},Ia={class:"flex justify-between items-center"},Da={class:"text-base font-bold text-purple-600"},Ca={class:"bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-xl border-2 border-green-200"},Ma={class:"flex justify-between items-center"},La={class:"text-right"},ja={class:"text-3xl font-bold text-green-600"},Ba={class:"flex justify-end gap-3 pt-6 border-t-2 border-gray-100"},Ta=["disabled"],Sa={key:0,class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},_a={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Va=F({__name:"AddPesananViewModal",props:{lokasiList:{}},emits:["close","order-reported"],setup(j,{emit:b}){const h=j,v=b,s=y(!1),d=y([]),i=y([]),o=y({lokasiId:null,namaPelanggan:"",kontakPelanggan:"",alamatPengiriman:"Pesanan Offline",items:[{produkId:null,ukuranId:null,quantity:1,subtotal:0}]}),f=$(()=>o.value.items.length),M=$(()=>o.value.items.reduce((a,t)=>a+t.subtotal,0)),B=a=>new Intl.NumberFormat("id-ID").format(a),T=()=>{o.value.items.push({produkId:null,ukuranId:null,quantity:1,subtotal:0})},w=a=>{o.value.items.length>1&&o.value.items.splice(a,1)},L=$(()=>a=>a?i.value.filter(t=>t.produkId===a):[]),S=a=>d.value.find(t=>t.produkId===a),_=a=>i.value.find(t=>t.ukuranId===a),U=a=>{const t=S(a.produkId),r=_(a.ukuranId);if(t){const x=t.harga,k=r?r.hargaTambahan:0,H=Number(x)+Number(k);a.subtotal=H*a.quantity}else a.subtotal=0},R=async()=>{if(M.value<=0){alert("Total pesanan harus lebih dari Rp 0.");return}const a=o.value.items.map(r=>({produkId:r.produkId,ukuranId:r.ukuranId,quantity:r.quantity,subtotal:r.subtotal})),t={lokasiId:o.value.lokasiId,namaPelanggan:o.value.namaPelanggan,kontakPelanggan:o.value.kontakPelanggan||null,alamatPengiriman:o.value.alamatPengiriman,totalHarga:M.value,items:a};s.value=!0;try{await le(t),alert("Pesanan offline berhasil dilaporkan!"),v("order-reported"),v("close")}catch(r){console.error("Error submitting offline order:",r);let x="Terjadi kesalahan tidak dikenal saat melaporkan pesanan.";r&&typeof r=="object"&&r.response&&r.response.data&&r.response.data.message?x=r.response.data.message:r instanceof Error&&(x=r.message),alert(`Gagal melaporkan pesanan: ${x}`)}finally{s.value=!1}},l=async()=>{try{const[a,t]=await Promise.all([ie(),de()]);d.value=a.data.map(x=>({produkId:Number(x.produkId),namaProduk:x.namaProduk,harga:Number(x.harga||0)})).filter(x=>x.produkId>0);const r=t.data;i.value=r.map(x=>({ukuranId:Number(x.ukuranId),produkId:Number(x.produkId),namaUkuran:x.namaUkuran,hargaTambahan:Number(x.hargaTambahan||0)})).filter(x=>x.ukuranId>0),console.log(`DEBUG: Produk dimuat: ${d.value.length}`),console.log(`DEBUG: Ukuran dimuat: ${i.value.length}`),d.value.length===0&&alert("Peringatan: Data Produk kosong. Pastikan tabel Produk terisi di database lokal.")}catch(a){console.error("Gagal memuat master data (API Crash):",a);let t="Terjadi kesalahan tidak dikenal.";a instanceof Error&&(t=a.message),alert(`Gagal memuat data master: ${t}. Cek konsol backend.`)}};return ee(()=>{l()}),(a,t)=>(m(),g("div",{class:"fixed inset-0 z-40 overflow-y-auto h-full w-full transition-all duration-300",style:{"background-color":"rgba(0, 0, 0, 0.7)"},onClick:t[5]||(t[5]=X(r=>a.$emit("close"),["self"]))},[e("div",ea,[e("div",ta,[t[7]||(t[7]=e("div",null,[e("h3",{class:"text-2xl font-bold text-gray-900 flex items-center gap-2"},[e("svg",{class:"w-7 h-7 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})]),P(" Input Pesanan Offline ")]),e("p",{class:"text-sm text-gray-500 mt-1"},"Laporkan pesanan manual dari penjualan langsung")],-1)),e("button",{class:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 p-2 rounded-full transition-all duration-200",onClick:t[0]||(t[0]=r=>a.$emit("close"))},[...t[6]||(t[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:X(R,["prevent"]),class:"mt-6 space-y-6"},[e("div",aa,[t[12]||(t[12]=e("h4",{class:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})]),P(" Informasi Pelanggan ")],-1)),e("div",sa,[e("div",null,[t[8]||(t[8]=e("label",{for:"namaPelanggan",class:"block text-sm font-semibold text-gray-700 mb-2"},"Nama Pelanggan *",-1)),A(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=r=>o.value.namaPelanggan=r),id:"namaPelanggan",required:"",placeholder:"Masukkan nama pelanggan",class:"block w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all duration-200 sm:text-sm"},null,512),[[K,o.value.namaPelanggan]])]),e("div",null,[t[9]||(t[9]=e("label",{for:"kontakPelanggan",class:"block text-sm font-semibold text-gray-700 mb-2"},"Kontak Pelanggan (Optional)",-1)),A(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=r=>o.value.kontakPelanggan=r),id:"kontakPelanggan",placeholder:"Nomor telepon/WhatsApp",class:"block w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all duration-200 sm:text-sm"},null,512),[[K,o.value.kontakPelanggan]])])]),e("div",na,[t[11]||(t[11]=e("label",{for:"lokasiId",class:"block text-sm font-semibold text-gray-700 mb-2"},"Lokasi Penjualan *",-1)),A(e("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.value.lokasiId=r),id:"lokasiId",required:"",class:"block w-full px-4 py-3 rounded-lg border-2 border-gray-200 focus:border-blue-500 focus:ring-4 focus:ring-blue-100 transition-all duration-200 sm:text-sm bg-white"},[t[10]||(t[10]=e("option",{disabled:"",value:""},"Pilih Lokasi",-1)),(m(!0),g(D,null,C(h.lokasiList,r=>(m(),g("option",{key:r.id||r.lokasiId,value:r.id||r.lokasiId},u(r.name||r.namaLokasi),9,ra))),128))],512),[[Y,o.value.lokasiId]])])]),e("div",oa,[e("div",la,[t[13]||(t[13]=e("h4",{class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})]),P(" Detail Item Pesanan ")],-1)),e("span",ia,u(f.value)+" Item",1)]),e("div",da,[(m(!0),g(D,null,C(o.value.items,(r,x)=>(m(),g("div",{key:x,class:"p-4 border-2 border-white rounded-xl bg-white shadow-sm hover:shadow-md transition-all duration-200"},[e("div",ua,[e("div",pa,[e("span",ma,u(x+1),1),e("span",ga,"Item #"+u(x+1),1)]),e("button",{type:"button",onClick:k=>w(x),class:"text-red-500 hover:text-red-700 hover:bg-red-50 p-2 rounded-full transition-all duration-200",disabled:o.value.items.length===1},[...t[14]||(t[14]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ca)]),e("div",ba,[e("div",va,[t[16]||(t[16]=e("label",{class:"block text-xs font-semibold text-gray-600 mb-1"},"Produk *",-1)),A(e("select",{"onUpdate:modelValue":k=>r.produkId=k,onChange:k=>U(r),required:"",class:"block w-full px-3 py-2 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all duration-200 text-sm bg-white"},[t[15]||(t[15]=e("option",{disabled:"",value:""},"Pilih Produk",-1)),(m(!0),g(D,null,C(d.value,k=>(m(),g("option",{key:k.produkId,value:k.produkId},u(k.namaProduk),9,fa))),128))],40,xa),[[Y,r.produkId]])]),e("div",ka,[t[18]||(t[18]=e("label",{class:"block text-xs font-semibold text-gray-600 mb-1"},"Ukuran *",-1)),A(e("select",{"onUpdate:modelValue":k=>r.ukuranId=k,onChange:k=>U(r),required:"",class:"block w-full px-3 py-2 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all duration-200 text-sm bg-white",disabled:!L.value(r.produkId).length},[t[17]||(t[17]=e("option",{disabled:"",value:""},"Pilih Ukuran",-1)),(m(!0),g(D,null,C(L.value(r.produkId),k=>(m(),g("option",{key:k.ukuranId,value:k.ukuranId},u(k.namaUkuran),9,ya))),128))],40,ha),[[Y,r.ukuranId]])]),e("div",wa,[t[19]||(t[19]=e("label",{class:"block text-xs font-semibold text-gray-600 mb-1"},"Jumlah *",-1)),A(e("input",{type:"number","onUpdate:modelValue":k=>r.quantity=k,onInput:k=>U(r),required:"",min:"1",class:"block w-full px-3 py-2 rounded-lg border-2 border-gray-200 focus:border-purple-500 focus:ring-4 focus:ring-purple-100 transition-all duration-200 text-sm text-center font-semibold"},null,40,Pa),[[K,r.quantity,void 0,{number:!0}]])])]),e("div",$a,[e("div",Ia,[t[20]||(t[20]=e("span",{class:"text-xs font-medium text-gray-500"},"Subtotal Item",-1)),e("span",Da,"Rp "+u(B(r.subtotal)),1)])])]))),128))]),e("button",{type:"button",onClick:T,class:"w-full mt-4 flex items-center justify-center gap-2 px-4 py-3 text-sm font-semibold text-purple-600 bg-white border-2 border-dashed border-purple-300 rounded-xl hover:bg-purple-50 hover:border-purple-500 transition-all duration-200"},[...t[21]||(t[21]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),P(" Tambah Item Baru ",-1)])])]),e("div",Ca,[e("div",Ma,[t[22]||(t[22]=e("div",null,[e("p",{class:"text-sm text-gray-600 font-medium mb-1"},"Total Keseluruhan"),e("p",{class:"text-xs text-gray-500"},"Dihitung otomatis dari semua item")],-1)),e("div",La,[e("p",ja,"Rp "+u(B(M.value)),1)])])]),e("div",Ba,[e("button",{type:"button",onClick:t[4]||(t[4]=r=>a.$emit("close")),class:"px-6 py-3 text-sm font-semibold text-gray-700 bg-white border-2 border-gray-300 rounded-xl hover:bg-gray-50 hover:border-gray-400 transition-all duration-200"}," Batal "),e("button",{type:"submit",disabled:s.value,class:"px-6 py-3 text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl hover:from-blue-700 hover:to-indigo-700 shadow-lg hover:shadow-xl transition-all duration-200 disabled:from-blue-400 disabled:to-indigo-400 disabled:cursor-not-allowed flex items-center gap-2"},[s.value?(m(),g("svg",Sa,[...t[23]||(t[23]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(m(),g("svg",_a,[...t[24]||(t[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])),P(" "+u(s.value?"Menyimpan...":"Laporkan Pesanan"),1)],8,Ta)])],32)])]))}}),Ua={class:"p-6 bg-gray-50 min-h-screen"},Oa={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-6 text-center"},Aa={class:"text-red-600 mb-4"},Na={key:1,class:"space-y-6"},za=F({__name:"KelolaPesanan",setup(j){const b=ue(),h=y(null),v=y(!0),s=y(null),d=y([]),i=y([]),o=y("all"),f=y([]),M=y(0),B=y(!1),T=y(null),w=y(!1),L=y(""),S=y(""),_=y("all"),U=$(()=>[{label:"Semua",value:"all",count:d.value.length},{label:"Perlu Validasi",value:"perlu-validasi",count:d.value.filter(n=>n.statusPesanan==="Perlu Validasi").length},{label:"Perlu Dikirim",value:"perlu-dikirim",count:d.value.filter(n=>n.statusPesanan==="Perlu Dikirim").length},{label:"Dikirim",value:"dikirim",count:d.value.filter(n=>n.statusPesanan==="Dikirim").length},{label:"Selesai",value:"selesai",count:d.value.filter(n=>n.statusPesanan==="Selesai").length},{label:"Dibatalkan",value:"dibatalkan",count:d.value.filter(n=>n.statusPesanan==="Dibatalkan").length}]),R=$(()=>({perluValidasi:d.value.filter(n=>n.statusPesanan==="Perlu Validasi").length,perluDikirim:d.value.filter(n=>n.statusPesanan==="Perlu Dikirim").length,dikirim:d.value.filter(n=>n.statusPesanan==="Dikirim").length,selesai:d.value.filter(n=>n.statusPesanan==="Selesai").length,dibatalkan:d.value.filter(n=>n.statusPesanan==="Dibatalkan").length})),l=$(()=>{switch(o.value){case"all":return d.value;case"perlu-validasi":return d.value.filter(n=>n.statusPesanan==="Perlu Validasi");case"perlu-dikirim":return d.value.filter(n=>n.statusPesanan==="Perlu Dikirim");case"dikirim":return d.value.filter(n=>n.statusPesanan==="Dikirim");case"selesai":return d.value.filter(n=>n.statusPesanan==="Selesai");case"dibatalkan":return d.value.filter(n=>n.statusPesanan==="Dibatalkan");default:return d.value}}),a=async()=>{v.value=!0,s.value=null;try{const[n,p]=await Promise.all([me(L.value,S.value,_.value),ge()]);d.value=n.data,i.value=p.data,d.value.length===0&&console.log("Tidak ada pesanan yang tersedia.")}catch(n){console.error("Error loading data:",n),s.value=n.response?.data?.message||"Gagal memuat data. Coba segarkan halaman."}finally{v.value=!1}},t=n=>{o.value=n,f.value=[]},r=n=>{t(n);const p=document.querySelector(".bg-white.rounded-t-lg");p&&p.scrollIntoView({behavior:"smooth",block:"start"})},x=n=>{n.target.checked?f.value=l.value.map(c=>c.pesananId):f.value=[]},k=n=>{f.value=n},H=async n=>{if(n.statusPesanan==="Dibatalkan"){const c=await h.value?.open({title:"Batalkan Pesanan",message:"Anda yakin ingin membatalkan pesanan ini? Aksi ini tidak dapat dikembalikan.",confirmButtonText:"Ya, Batalkan",cancelButtonText:"Tutup",variant:"danger",showInput:!0,inputPlaceholder:"Masukkan alasan pembatalan..."});if(!c?.confirmed){await a();return}const O=c.value||"-";try{await z(n.pesananId,"Dibatalkan",O),b.success(`Pesanan #${n.pesananId} berhasil dibatalkan.`);const I=d.value.findIndex(G=>G.pesananId===n.pesananId);I!==-1&&(d.value[I].statusPesanan="Dibatalkan"),await a()}catch(I){console.error("Error membatalkan pesanan:",I),b.error(I.response?.data?.message||"Gagal membatalkan pesanan."),await a()}return}if(n.statusPesanan==="Dikirim"){const c=await h.value?.open({title:"Konfirmasi Pengiriman",message:"Apakah pesanan ini sudah diserahkan ke kurir? Anda dapat memasukkan Link Tracking atau Resi (Opsional).",confirmButtonText:"Ya, Ubah Status",cancelButtonText:"Batal",variant:"warning",showInput:!0,inputRequired:!1,inputPlaceholder:"Masukkan Link Tracking / Nomor Resi (Opsional)..."});if(!c?.confirmed){await a();return}const O=c.value||"";try{await z(n.pesananId,"Dikirim",void 0,O),b.success(`Status pesanan #${n.pesananId} diperbarui ke Dikirim.`);const I=d.value.findIndex(G=>G.pesananId===n.pesananId);I!==-1&&(d.value[I].statusPesanan="Dikirim"),await a()}catch(I){console.error("Error update status:",I),b.error(I.response?.data?.message||"Gagal mengubah status pesanan."),await a()}return}if(!(await h.value?.open({title:"Konfirmasi Perubahan Status",message:`Anda yakin ingin mengubah status pesanan #${n.pesananId} menjadi "${n.statusPesanan}"?`,confirmButtonText:"Ya, Ubah Status",cancelButtonText:"Batal",variant:"warning",showInput:!1}))?.confirmed){await a();return}try{await z(n.pesananId,n.statusPesanan);const c=d.value.findIndex(O=>O.pesananId===n.pesananId);c!==-1&&(d.value[c].statusPesanan=n.statusPesanan),b.success(`Status pesanan #${n.pesananId} berhasil diubah menjadi: ${n.statusPesanan}`)}catch(c){console.error("Error updating status:",c),b.error(c.response?.data?.message||"Gagal mengubah status pesanan"),await a()}},te=async n=>{try{if(!n.lokasiId){b.error("Silakan pilih lokasi terlebih dahulu");return}await ce(n.pesananId,n.lokasiId);const p=d.value.findIndex(c=>c.pesananId===n.pesananId);p!==-1&&(d.value[p].lokasiId=n.lokasiId),b.success(`Lokasi pesanan #${n.pesananId} berhasil diubah`)}catch(p){console.error("Error updating lokasi:",p),b.error(p.response?.data?.message||"Gagal mengubah lokasi pesanan"),await a()}},ae=async n=>{try{const p=await be(n.pesananId);T.value=p.data,B.value=!0}catch(p){console.error("Error fetching detail:",p),b.error(p.response?.data?.message||"Gagal memuat detail pesanan")}},q=()=>{B.value=!1,T.value=null},se=()=>{w.value=!1,a()},ne=async n=>{if((await h.value?.open({title:"Validasi Pesanan",message:'Anda yakin ingin memvalidasi pesanan ini dan mengubah status menjadi "Perlu Dikirim"?',confirmButtonText:"Ya, Validasi",cancelButtonText:"Batal",variant:"warning"}))?.confirmed)try{await z(n,"Perlu Dikirim"),b.success(`Pesanan #${n} berhasil divalidasi dan siap dikirim.`),await a(),q()}catch(c){console.error("Error validasi pesanan:",c),b.error("Gagal memvalidasi pesanan.")}},re=async n=>{const p=await h.value?.open({title:"Batalkan Pesanan",message:"Anda yakin ingin membatalkan pesanan ini? Aksi ini tidak dapat dikembalikan.",confirmButtonText:"Ya, Batalkan",cancelButtonText:"Tutup",variant:"danger",showInput:!0,inputPlaceholder:"Masukkan alasan pembatalan..."});if(!p?.confirmed)return;const c=p.value||"-";try{await z(n,"Dibatalkan",c),b.success(`Pesanan #${n} berhasil dibatalkan.`),await a(),q()}catch(O){console.error("Error membatalkan pesanan:",O),b.error("Gagal membatalkan pesanan.")}};return ee(()=>{a()}),Z([L,S,_],()=>{a()}),(n,p)=>(m(),g("div",Ua,[J(pe,{ref_key:"confirmModalRef",ref:h,title:"Konfirmasi Aksi",message:"Apakah Anda yakin?","confirm-button-text":"Ya","cancel-button-text":"Tidak",variant:"warning"},null,512),p[8]||(p[8]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Kelola Pesanan"),e("p",{class:"text-sm text-gray-600"},[P(" Perbarui metrik pemenuhan pesanan "),e("a",{href:"#",class:"text-blue-600 hover:underline ml-1"},"Lihat selengkapnya")])],-1)),s.value?(m(),g("div",Oa,[p[6]||(p[6]=e("svg",{class:"mx-auto h-12 w-12 text-red-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),p[7]||(p[7]=e("h3",{class:"text-lg font-medium text-red-800 mb-2"},"Gagal Memuat Data Pesanan",-1)),e("p",Aa,u(s.value),1),e("button",{onClick:a,class:"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors duration-200"}," Coba Lagi ")])):(m(),g("div",Na,[J(Be,{"action-cards":R.value,onFilterStatus:r,onRefresh:a,onOpenAddModal:p[0]||(p[0]=c=>w.value=!0)},null,8,["action-cards"]),J(ht,{loading:v.value,tabs:U.value,"active-tab":o.value,"pesanan-list":l.value,"selected-orders":f.value,"lokasi-list":i.value,"active-filters":M.value,startDate:L.value,"onUpdate:startDate":p[1]||(p[1]=c=>L.value=c),endDate:S.value,"onUpdate:endDate":p[2]||(p[2]=c=>S.value=c),tipePesananFilter:_.value,"onUpdate:tipePesananFilter":p[3]||(p[3]=c=>_.value=c),onChangeTab:t,onToggleSelectAll:x,onUpdateSelected:k,onUpdateStatus:H,onUpdateLokasi:te,onOpenDetail:ae,onOpenAddModal:p[4]||(p[4]=c=>w.value=!0)},null,8,["loading","tabs","active-tab","pesanan-list","selected-orders","lokasi-list","active-filters","startDate","endDate","tipePesananFilter"])])),B.value&&T.value?(m(),W(Zt,{key:2,pesanan:T.value,"lokasi-list":i.value,onClose:q,onValidateOrder:ne,onCancelOrder:re},null,8,["pesanan","lokasi-list"])):V("",!0),w.value?(m(),W(Va,{key:3,"lokasi-list":i.value,onClose:p[5]||(p[5]=c=>w.value=!1),onOrderReported:se},null,8,["lokasi-list"])):V("",!0)]))}});export{za as default};
