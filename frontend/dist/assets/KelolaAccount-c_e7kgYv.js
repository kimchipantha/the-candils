import{ah as q,d as B,a as b,o as g,b as e,f as E,F as N,r as T,t as v,n as D,C as V,h as c,c as L,s as U,Q as $,i as C,j as x,v as y,k as S,B as M,ai as j,w as I,q as R,x as h,e as F}from"./index-BWtGjQtB.js";const z="https://backend-the-candils.vercel.app/api",k=q.create({baseURL:z});k.interceptors.request.use(n=>{const l=localStorage.getItem("authToken");return l&&(n.headers.Authorization=`Bearer ${l}`),n},n=>Promise.reject(n));const G=()=>k.get("/users"),P=n=>k.post("/users",n),H=(n,l)=>k.put(`/users/${n}`,l),K=n=>k.delete(`/users/${n}`),_={class:"overflow-x-auto"},O={class:"min-w-full divide-y divide-gray-200"},Q={class:"bg-white divide-y divide-gray-200"},J={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},W={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},X={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Y={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Z=["onClick"],ee=["onClick"],se={key:0},te=B({__name:"AccountTable",props:{users:{}},emits:["edit","delete"],setup(n){return(l,i)=>(g(),b("div",_,[e("table",O,[i[1]||(i[1]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Username"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Nama Lengkap"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Aksi")])],-1)),e("tbody",Q,[(g(!0),b(N,null,T(l.users,r=>(g(),b("tr",{key:r.userId,class:"hover:bg-gray-50 transition-colors duration-150"},[e("td",J,v(r.username),1),e("td",W,v(r.namaLengkap),1),e("td",X,[e("span",{class:D(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",r.role==="Super Admin"?"bg-purple-100 text-purple-800":"bg-green-100 text-green-800"])},v(r.role),3)]),e("td",Y,[e("button",{onClick:m=>l.$emit("edit",r),class:"text-indigo-600 hover:text-indigo-900 mr-4"},"Edit",8,Z),e("button",{onClick:m=>l.$emit("delete",r.userId),class:"text-red-600 hover:text-red-900"},"Hapus",8,ee)])]))),128)),l.users.length===0?(g(),b("tr",se,[...i[0]||(i[0]=[e("td",{colspan:"4",class:"px-6 py-10 text-center text-gray-500"}," Belum ada data user. ",-1)])])):E("",!0)])])]))}}),ae={class:"flex justify-end gap-3 mt-6"},oe=["disabled"],re=B({__name:"AddAccountModal",props:{isVisible:{type:Boolean}},emits:["update:isVisible","success"],setup(n,{emit:l}){const i=n,r=l,m=V(),u=c(!1),a=c({username:"",namaLengkap:"",role:"Admin",password:""}),p=L({get:()=>i.isVisible,set:o=>r("update:isVisible",o)}),f=()=>{a.value={username:"",namaLengkap:"",role:"Admin",password:""}},w=async()=>{u.value=!0;try{await P(a.value),m.success("Akun berhasil dibuat!"),r("success")}catch(o){console.error("Create user error:",o),m.error(o.response?.data?.message||"Gagal membuat akun.")}finally{u.value=!1}};return(o,s)=>(g(),U(M(j),{modelValue:p.value,"onUpdate:modelValue":s[5]||(s[5]=t=>p.value=t),class:"flex justify-center items-center","content-class":"bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-4",onClosed:f},{default:$(()=>[s[11]||(s[11]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-bold text-gray-900"},"Tambah Akun Baru"),e("p",{class:"text-sm text-gray-500"},"Masukkan detail akun baru di bawah ini.")],-1)),e("form",{onSubmit:C(w,["prevent"]),class:"space-y-4"},[e("div",null,[s[6]||(s[6]=e("label",{for:"username",class:"block text-sm font-medium text-gray-700"},"Username",-1)),x(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>a.value.username=t),type:"text",id:"username",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border"},null,512),[[y,a.value.username]])]),e("div",null,[s[7]||(s[7]=e("label",{for:"namaLengkap",class:"block text-sm font-medium text-gray-700"},"Nama Lengkap",-1)),x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.value.namaLengkap=t),type:"text",id:"namaLengkap",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border"},null,512),[[y,a.value.namaLengkap]])]),e("div",null,[s[9]||(s[9]=e("label",{for:"role",class:"block text-sm font-medium text-gray-700"},"Role",-1)),x(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>a.value.role=t),id:"role",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border bg-white"},[...s[8]||(s[8]=[e("option",{value:"Admin"},"Admin",-1),e("option",{value:"Super Admin"},"Super Admin",-1)])],512),[[S,a.value.role]])]),e("div",null,[s[10]||(s[10]=e("label",{for:"password",class:"block text-sm font-medium text-gray-700"},"Password",-1)),x(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>a.value.password=t),type:"password",id:"password",required:"",minlength:"6",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border"},null,512),[[y,a.value.password]])]),e("div",ae,[e("button",{type:"button",onClick:s[4]||(s[4]=t=>p.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#BAB772]"}," Batal "),e("button",{type:"submit",disabled:u.value,class:"px-4 py-2 text-sm font-medium text-white bg-[#BAB772] border border-transparent rounded-md hover:bg-[#a8a668] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#BAB772] disabled:opacity-75"},v(u.value?"Menyimpan...":"Simpan"),9,oe)])],32)]),_:1},8,["modelValue"]))}}),ne={class:"flex justify-end gap-3 mt-6"},le=["disabled"],ie=B({__name:"EditAccountModal",props:{isVisible:{type:Boolean},user:{}},emits:["update:isVisible","success"],setup(n,{emit:l}){const i=n,r=l,m=V(),u=c(!1),a=c({username:"",namaLengkap:"",role:"Admin",password:""}),p=L({get:()=>i.isVisible,set:o=>r("update:isVisible",o)});I(()=>i.user,o=>{o&&(a.value={username:o.username,namaLengkap:o.namaLengkap,role:o.role,password:""})});const f=()=>{a.value={username:"",namaLengkap:"",role:"Admin",password:""}},w=async()=>{if(i.user){u.value=!0;try{const o={username:a.value.username,namaLengkap:a.value.namaLengkap,role:a.value.role};a.value.password&&(o.password=a.value.password),await H(i.user.userId,o),m.success("Akun berhasil diupdate!"),r("success")}catch(o){console.error("Update user error:",o),m.error(o.response?.data?.message||"Gagal update akun.")}finally{u.value=!1}}};return(o,s)=>(g(),U(M(j),{modelValue:p.value,"onUpdate:modelValue":s[5]||(s[5]=t=>p.value=t),class:"flex justify-center items-center","content-class":"bg-white p-6 rounded-lg shadow-xl w-full max-w-md mx-4",onClosed:f},{default:$(()=>[s[11]||(s[11]=e("div",{class:"mb-4"},[e("h3",{class:"text-lg font-bold text-gray-900"},"Edit Akun"),e("p",{class:"text-sm text-gray-500"},"Edit detail akun. Kosongkan password jika tidak ingin mengubahnya.")],-1)),e("form",{onSubmit:C(w,["prevent"]),class:"space-y-4"},[e("div",null,[s[6]||(s[6]=e("label",{for:"edit-username",class:"block text-sm font-medium text-gray-700"},"Username",-1)),x(e("input",{"onUpdate:modelValue":s[0]||(s[0]=t=>a.value.username=t),type:"text",id:"edit-username",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border"},null,512),[[y,a.value.username]])]),e("div",null,[s[7]||(s[7]=e("label",{for:"edit-namaLengkap",class:"block text-sm font-medium text-gray-700"},"Nama Lengkap",-1)),x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>a.value.namaLengkap=t),type:"text",id:"edit-namaLengkap",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border"},null,512),[[y,a.value.namaLengkap]])]),e("div",null,[s[9]||(s[9]=e("label",{for:"edit-role",class:"block text-sm font-medium text-gray-700"},"Role",-1)),x(e("select",{"onUpdate:modelValue":s[2]||(s[2]=t=>a.value.role=t),id:"edit-role",required:"",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border bg-white"},[...s[8]||(s[8]=[e("option",{value:"Admin"},"Admin",-1),e("option",{value:"Super Admin"},"Super Admin",-1)])],512),[[S,a.value.role]])]),e("div",null,[s[10]||(s[10]=e("label",{for:"edit-password",class:"block text-sm font-medium text-gray-700"},"Password Baru (Opsional)",-1)),x(e("input",{"onUpdate:modelValue":s[3]||(s[3]=t=>a.value.password=t),type:"password",id:"edit-password",minlength:"6",placeholder:"Isi hanya jika ingin ganti password",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-[#BAB772] focus:ring focus:ring-[#BAB772] focus:ring-opacity-50 sm:text-sm p-2 border"},null,512),[[y,a.value.password]])]),e("div",ne,[e("button",{type:"button",onClick:s[4]||(s[4]=t=>p.value=!1),class:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#BAB772]"}," Batal "),e("button",{type:"submit",disabled:u.value,class:"px-4 py-2 text-sm font-medium text-white bg-[#BAB772] border border-transparent rounded-md hover:bg-[#a8a668] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#BAB772] disabled:opacity-75"},v(u.value?"Menyimpan...":"Simpan"),9,le)])],32)]),_:1},8,["modelValue"]))}}),ue={class:"p-8"},de={key:0,class:"flex justify-center py-10"},me={key:1,class:"bg-red-50 text-red-600 p-4 rounded-lg mb-4"},pe={key:2,class:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden"},ge=B({__name:"KelolaAccount",setup(n){const l=V(),i=c([]),r=c(!0),m=c(""),u=c(!1),a=c(!1),p=c(null),f=async()=>{r.value=!0,m.value="";try{const t=await G();i.value=t.data}catch(t){console.error("Fetch users error:",t),m.value=t.response?.data?.message||"Gagal memuat data pengguna."}finally{r.value=!1}},w=()=>{u.value=!0},o=t=>{p.value=t,a.value=!0},s=async t=>{if(confirm("Apakah Anda yakin ingin menghapus akun ini?"))try{await K(t),l.success("Akun berhasil dihapus"),f()}catch(d){console.error("Delete user error:",d),l.error(d.response?.data?.message||"Gagal menghapus akun.")}};return R(()=>{f()}),(t,d)=>(g(),b("div",ue,[e("div",{class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6"},[d[3]||(d[3]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-800"},"Kelola Akun"),e("p",{class:"text-gray-600 mt-1"},"Daftar akun Admin dan Super Admin")],-1)),e("button",{onClick:w,class:"mt-4 lg:mt-0 bg-[#BAB772] text-white px-6 py-3 rounded-lg font-medium hover:bg-[#a8a668] transition-colors duration-200 flex items-center gap-2"},[...d[2]||(d[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),F(" Tambah Akun ",-1)])])]),r.value?(g(),b("div",de,[...d[4]||(d[4]=[e("svg",{class:"h-10 w-10 text-[#BAB772] animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):m.value?(g(),b("div",me,v(m.value),1)):(g(),b("div",pe,[h(te,{users:i.value,onEdit:o,onDelete:s},null,8,["users"])])),h(re,{"is-visible":u.value,"onUpdate:isVisible":d[0]||(d[0]=A=>u.value=A),onSuccess:f},null,8,["is-visible"]),h(ie,{"is-visible":a.value,"onUpdate:isVisible":d[1]||(d[1]=A=>a.value=A),user:p.value,onSuccess:f},null,8,["is-visible","user"])]))}});export{ge as default};
