import{d as S,c as z,a as c,o as u,b as e,e as F,t as v,f as A,F as j,r as E,n as K,g as O,h as b,w as q,i as R,j as D,v as M,k as J,l as W,u as Z,m as Q,p as X,q as Y,s as ee,x as H,y as te,z as L,A as oe}from"./index-BWtGjQtB.js";const ae={class:"bg-white rounded-xl shadow-lg p-6"},se={class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6"},re={key:0,class:"text-center py-12 bg-red-50 rounded-lg"},le={class:"mt-1 text-sm text-red-700"},ne={key:1},ie={class:"overflow-x-auto"},de={class:"w-full"},ue={key:0},ce={class:"px-4 py-3 text-sm text-gray-900"},me={class:"px-4 py-3"},ge=["src","alt"],pe={class:"px-4 py-3 text-sm font-medium text-gray-900"},be={class:"px-4 py-3 text-sm font-medium text-blue-600"},fe={class:"px-4 py-3 text-sm text-gray-700"},xe={class:"px-4 py-3 text-sm text-gray-700"},ve={class:"px-4 py-3 text-sm font-bold text-gray-900"},ke={class:"px-4 py-3 text-sm text-gray-700"},ye={class:"px-4 py-3 text-center"},he=["onClick"],we={class:"px-4 py-3"},Pe=["onClick"],Ae=["onClick"],Be={key:0,class:"text-center py-12"},Ue={key:1,class:"flex flex-col sm:flex-row items-center justify-between mt-6 pt-4 border-t border-gray-100"},Ce={class:"text-sm text-gray-600 mb-4 sm:mb-0"},$e={class:"font-medium text-gray-900"},De={class:"font-medium text-gray-900"},Me={class:"font-medium text-gray-900"},Te={class:"flex gap-2"},Ne=["disabled"],Ie=["disabled"],_e=S({__name:"ProductTable",props:{productVariants:{},isLoading:{type:Boolean},errorMessage:{},currentPage:{},totalPages:{},totalItems:{}},emits:["addProduct","editProduct","deleteProduct","refreshDataFromApi","changePage","toggleStatus"],setup(N,{emit:T}){const i=N,w=T,f=z(()=>i.productVariants.length>0);z(()=>i.productVariants.length);const t=()=>w("refreshDataFromApi"),p=s=>s==null||isNaN(s)?"Rp -":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),B=(s,o)=>{const n=parseFloat(s),P=parseFloat(o),C=!isNaN(n),U=!isNaN(P)||o===null||o===void 0;if(C){const $=U?isNaN(P)?0:P:0;return n+$}return null},y=s=>s&&(s.startsWith("http://")||s.startsWith("https://"))?s:"https://placehold.co/64x64/eee/ccc?text=No+Image",k=s=>{const o=s.target;o.src="https://placehold.co/64x64/eee/ccc?text=Error"};return(s,o)=>(u(),c("div",ae,[e("div",se,[o[4]||(o[4]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-800"},"Kelola Produk & Varian"),e("p",{class:"text-gray-600 mt-1"},"Setiap baris mewakili satu varian produk")],-1)),e("button",{onClick:o[0]||(o[0]=n=>s.$emit("addProduct")),class:"mt-4 lg:mt-0 bg-[#BAB772] text-white px-6 py-3 rounded-lg font-medium hover:bg-[#a8a668] transition-colors duration-200 flex items-center gap-2"},[...o[3]||(o[3]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),F(" Tambah Produk ",-1)])])]),s.errorMessage?(u(),c("div",re,[o[5]||(o[5]=e("svg",{class:"mx-auto h-12 w-12 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),o[6]||(o[6]=e("h3",{class:"mt-2 text-sm font-medium text-red-800"},"Terjadi Kesalahan",-1)),e("p",le,v(s.errorMessage),1),e("button",{onClick:t,class:"mt-4 px-4 py-2 bg-blue-100 text-blue-800 rounded-md text-sm font-medium hover:bg-blue-200"}," Coba Lagi ")])):(u(),c("div",ne,[e("div",ie,[e("table",de,[o[9]||(o[9]=e("thead",null,[e("tr",{class:"bg-gray-50 border-b border-gray-200"},[e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"No."),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"GAMBAR"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"NAMA PRODUK"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"VARIAN"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"HARGA DASAR"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"HRG. TAMBAHAN"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"HARGA FINAL"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"STOK"),e("th",{class:"px-4 py-3 text-center text-sm font-medium text-gray-700"},"STATUS"),e("th",{class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},"ACTION")])],-1)),f.value?(u(),c("tbody",ue,[(u(!0),c(j,null,E(s.productVariants,(n,P)=>(u(),c("tr",{key:`${n.produkId}-${n.ukuranId||"base"}`,class:"border-b border-gray-100 hover:bg-gray-50"},[e("td",ce,v(P+1),1),e("td",me,[e("img",{src:y(n.foto),alt:n.namaProduk,class:"w-16 h-16 object-cover rounded-lg border border-gray-200",onError:k},null,40,ge)]),e("td",pe,v(n.namaProduk),1),e("td",be,v(n.namaUkuran||"-"),1),e("td",fe,v(p(n.hargaUnit)),1),e("td",xe,"(+"+v(p(n.hargaTambahan))+")",1),e("td",ve,v(p(B(n.hargaUnit,n.hargaTambahan))),1),e("td",ke,v(n.stok),1),e("td",ye,[e("button",{onClick:C=>s.$emit("toggleStatus",n.produkId,!n.is_active),class:K([n.is_active?"bg-green-500":"bg-gray-300","relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"])},[e("span",{class:K([n.is_active?"translate-x-6":"translate-x-1","inline-block h-4 w-4 transform rounded-full bg-white transition-transform"])},null,2)],10,he)]),e("td",we,[e("button",{onClick:C=>s.$emit("editProduct",n.produkId),class:"text-blue-600 hover:text-blue-800 mr-2",title:"Edit Produk"},[...o[7]||(o[7]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Pe),e("button",{onClick:C=>s.$emit("deleteProduct",n.produkId),class:"text-red-600 hover:text-red-800",title:"Hapus Produk"},[...o[8]||(o[8]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Ae)])]))),128))])):A("",!0)])]),f.value?A("",!0):(u(),c("div",Be,[...o[10]||(o[10]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Belum ada produk",-1),e("p",{class:"mt-1 text-sm text-gray-500"},"Mulai dengan menambahkan produk pertama.",-1)])])),f.value?(u(),c("div",Ue,[e("div",Ce,[o[11]||(o[11]=F(" Menampilkan halaman ",-1)),e("span",$e,v(s.currentPage),1),o[12]||(o[12]=F(" dari ",-1)),e("span",De,v(s.totalPages),1),o[13]||(o[13]=e("span",{class:"text-gray-400 mx-2"},"|",-1)),o[14]||(o[14]=F(" Total ",-1)),e("span",Me,v(s.totalItems),1),o[15]||(o[15]=F(" varian ",-1))]),e("div",Te,[e("button",{onClick:o[1]||(o[1]=n=>s.$emit("changePage",s.currentPage-1)),disabled:s.currentPage===1,class:"px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Previous ",8,Ne),e("button",{onClick:o[2]||(o[2]=n=>s.$emit("changePage",s.currentPage+1)),disabled:s.currentPage===s.totalPages,class:"px-4 py-2 border border-gray-200 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"}," Next ",8,Ie)])])):A("",!0)]))]))}}),Ve={class:"px-4 py-3 text-sm font-medium text-gray-900"},Fe=S({__name:"ProductTableSkeleton",setup(N){return(T,i)=>(u(),c("tbody",null,[(u(),c(j,null,E(5,w=>e("tr",{key:w,class:"border-b border-gray-100 animate-pulse"},[i[0]||(i[0]=e("td",{class:"px-4 py-3 text-sm text-gray-900"},[e("div",{class:"h-3 bg-gray-300 rounded w-4"})],-1)),i[1]||(i[1]=e("td",{class:"px-4 py-3"},[e("div",{class:"w-16 h-16 bg-gray-300 rounded-lg"})],-1)),e("td",Ve,[e("div",{class:K(["h-4 bg-gray-300 rounded",w%2===0?"w-2/3":"w-4/5"])},null,2)]),i[2]||(i[2]=e("td",{class:"px-4 py-3 text-sm font-medium text-blue-600"},[e("div",{class:"h-4 bg-gray-300 rounded w-1/2"})],-1)),i[3]||(i[3]=e("td",{class:"px-4 py-3 text-sm text-gray-700"},[e("div",{class:"h-4 bg-gray-300 rounded w-3/4"})],-1)),i[4]||(i[4]=e("td",{class:"px-4 py-3 text-sm text-gray-700"},[e("div",{class:"h-4 bg-gray-300 rounded w-1/2"})],-1)),i[5]||(i[5]=e("td",{class:"px-4 py-3 text-sm font-bold text-gray-900"},[e("div",{class:"h-5 bg-gray-300 rounded w-2/3"})],-1)),i[6]||(i[6]=e("td",{class:"px-4 py-3 text-sm text-gray-700"},[e("div",{class:"h-4 bg-gray-300 rounded w-1/3"})],-1)),i[7]||(i[7]=e("td",{class:"px-4 py-3"},[e("div",{class:"flex gap-2"},[e("div",{class:"w-4 h-4 bg-gray-300 rounded"}),e("div",{class:"w-4 h-4 bg-gray-300 rounded"})])],-1))])),64))]))}}),Se={class:"p-6 space-y-6 max-h-[70vh] overflow-y-auto"},Re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},je={class:"flex items-center space-x-4"},Ee={class:"flex-shrink-0"},Ge=["src"],He={key:1,class:"w-24 h-24 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-gray-50"},ze={class:"flex-1"},Ke={key:0,class:"text-xs text-green-600 mt-1"},Le={key:0,class:"text-center text-sm text-gray-500 py-4"},Oe={class:"space-y-3"},qe=["onUpdate:modelValue"],Je=["onUpdate:modelValue"],We=["onClick"],Ze={key:0,class:"text-center text-sm text-red-600"},Qe={class:"flex justify-end gap-4 p-6 border-t border-gray-200"},Xe=["disabled"],Ye=S({__name:"AddProductModal",props:{isVisible:{type:Boolean}},emits:["close","productAdded"],setup(N,{emit:T}){const i=N,w=T,f=()=>({namaProduk:"",deskripsi:"",stok:0,hargaUnit:0,ukurans:[]}),t=O(f()),p=b(null),B=b(null),y=b(null),k=b(!1),s=b(null);q(()=>i.isVisible,g=>{g&&V()});const o=()=>{t.ukurans.push({namaUkuran:"",hargaTambahan:0})},n=g=>{t.ukurans.splice(g,1)},P=g=>{const l=g.target;if(l.files&&l.files[0]){const a=l.files[0];if(!["image/jpeg","image/png","image/webp"].includes(a.type)){s.value="Format file tidak didukung. Gunakan JPG, PNG, atau WEBP.";return}if(a.size>2*1024*1024){s.value="Ukuran file terlalu besar. Maksimal 2MB.";return}p.value=a;const d=new FileReader;d.onload=_=>{B.value=_.target?.result},d.readAsDataURL(a),s.value=null}},C=async()=>{if(s.value=null,!t.namaProduk||t.hargaUnit<=0||!p.value){s.value="Nama produk, harga unit, dan gambar wajib diisi.";return}if(t.ukurans.length===0){s.value="Minimal harus ada 1 varian ukuran.";return}k.value=!0;try{const g=new FormData;g.append("namaProduk",t.namaProduk),g.append("deskripsi",t.deskripsi),g.append("stok",t.stok.toString()),g.append("hargaUnit",t.hargaUnit.toString()),p.value&&g.append("foto",p.value),g.append("ukuran",JSON.stringify(t.ukurans)),await W(g),w("productAdded"),U()}catch(g){console.error("Error submitting form:",g),g.response&&g.response.data&&g.response.data.message?s.value=g.response.data.message:s.value="Terjadi kesalahan. Silakan coba lagi."}finally{k.value=!1}},U=()=>{k.value||(V(),w("close"))},$=()=>{U()},V=()=>{Object.assign(t,f()),t.ukurans=[],p.value=null,B.value=null,s.value=null,y.value&&(y.value.value="")},I=g=>{if(g===0)return"0 Bytes";const l=1024,a=["Bytes","KB","MB"],r=Math.floor(Math.log(g)/Math.log(l));return parseFloat((g/Math.pow(l,r)).toFixed(2))+" "+a[r]};return(g,l)=>g.isVisible?(u(),c("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",style:{"background-color":"rgba(0, 0, 0, 0.7)"},onClick:$},[e("div",{class:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4",onClick:l[5]||(l[5]=R(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between p-6 border-b border-gray-200"},[l[7]||(l[7]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Tambah Produk Baru",-1)),e("button",{onClick:U,class:"text-gray-400 hover:text-gray-600 transition-colors"},[...l[6]||(l[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:R(C,["prevent"])},[e("div",Se,[e("div",null,[l[8]||(l[8]=e("label",{for:"namaProduk",class:"block text-sm font-medium text-gray-700 mb-2"}," NAMA PRODUK ",-1)),D(e("input",{id:"namaProduk","onUpdate:modelValue":l[0]||(l[0]=a=>t.namaProduk=a),type:"text",required:"",placeholder:"Cth: Kopi Susu Gula Aren",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"},null,512),[[M,t.namaProduk]])]),e("div",null,[l[9]||(l[9]=e("label",{for:"deskripsi",class:"block text-sm font-medium text-gray-700 mb-2"}," DESKRIPSI ",-1)),D(e("textarea",{id:"deskripsi","onUpdate:modelValue":l[1]||(l[1]=a=>t.deskripsi=a),rows:"3",placeholder:"Deskripsi singkat produk...",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors resize-none"},null,512),[[M,t.deskripsi]])]),e("div",Re,[e("div",null,[l[10]||(l[10]=e("label",{for:"stok",class:"block text-sm font-medium text-gray-700 mb-2"}," STOK ",-1)),D(e("input",{id:"stok","onUpdate:modelValue":l[2]||(l[2]=a=>t.stok=a),type:"number",required:"",min:"0",placeholder:"0",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"},null,512),[[M,t.stok,void 0,{number:!0}]])]),e("div",null,[l[11]||(l[11]=e("label",{for:"hargaUnit",class:"block text-sm font-medium text-gray-700 mb-2"}," HARGA UNIT (Rp) ",-1)),D(e("input",{id:"hargaUnit","onUpdate:modelValue":l[3]||(l[3]=a=>t.hargaUnit=a),type:"number",required:"",min:"0",placeholder:"20000",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"},null,512),[[M,t.hargaUnit,void 0,{number:!0}]])])]),e("div",null,[l[14]||(l[14]=e("label",{for:"image",class:"block text-sm font-medium text-gray-700 mb-2"}," GAMBAR PRODUK ",-1)),e("div",je,[e("div",Ee,[B.value?(u(),c("img",{key:0,src:B.value,alt:"Preview",class:"w-24 h-24 object-cover rounded-lg border border-gray-200"},null,8,Ge)):(u(),c("div",He,[...l[12]||(l[12]=[e("svg",{class:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l-1.586-1.586a2 2 0 00-2.828 0L6 14m6-6v6m0 0v6m0-6h6m-6 0H6"})],-1)])]))]),e("div",ze,[e("input",{id:"image",ref_key:"fileInput",ref:y,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:P,class:"hidden"},null,544),e("button",{type:"button",onClick:l[4]||(l[4]=()=>y.value?.click()),class:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"}," Pilih Gambar "),l[13]||(l[13]=e("p",{class:"text-xs text-gray-500 mt-1"},"Format: JPG, PNG, WEBP. Maksimal 2MB",-1)),p.value?(u(),c("p",Ke," File dipilih: "+v(p.value.name)+" ("+v(I(p.value.size))+") ",1)):A("",!0)])])]),e("div",null,[l[16]||(l[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," VARIAN UKURAN ",-1)),t.ukurans.length===0?(u(),c("div",Le," Belum ada varian ukuran. ")):A("",!0),e("div",Oe,[(u(!0),c(j,null,E(t.ukurans,(a,r)=>(u(),c("div",{key:r,class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},[D(e("select",{"onUpdate:modelValue":d=>a.namaUkuran=d,required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-[#BAB772] focus:border-transparent bg-white"},[...l[15]||(l[15]=[e("option",{value:"",disabled:""},"Pilih Ukuran",-1),e("option",{value:"300ml"},"300ml",-1),e("option",{value:"500ml"},"500ml",-1)])],8,qe),[[J,a.namaUkuran]]),D(e("input",{"onUpdate:modelValue":d=>a.hargaTambahan=d,type:"number",required:"",placeholder:"Harga Tambahan (Rp)",class:"w-48 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-[#BAB772] focus:border-transparent"},null,8,Je),[[M,a.hargaTambahan,void 0,{number:!0}]]),e("button",{type:"button",onClick:d=>n(r),class:"text-red-500 hover:text-red-700 font-medium",title:"Hapus Ukuran"}," Hapus ",8,We)]))),128))]),e("button",{type:"button",onClick:o,class:"mt-3 px-4 py-2 border border-dashed border-[#BAB772] text-[#BAB772] rounded-lg text-sm font-medium hover:bg-[#FAFAD2] transition-colors w-full"}," + Tambah Varian Ukuran ")]),s.value?(u(),c("div",Ze,v(s.value),1)):A("",!0)]),e("div",Qe,[e("button",{type:"button",onClick:U,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 transition-colors duration-200"}," BATALKAN "),e("button",{type:"submit",disabled:k.value,class:"px-6 py-3 bg-[#BAB772] text-white rounded-lg font-medium hover:bg-[#a8a668] disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},v(k.value?"Menyimpan...":"SIMPAN"),9,Xe)])],32)])])):A("",!0)}}),et={class:"p-6 space-y-6 max-h-[70vh] overflow-y-auto"},tt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ot={class:"flex items-center space-x-4"},at={class:"flex-shrink-0"},st=["src"],rt={class:"flex-1"},lt={key:0,class:"text-xs text-green-600 mt-1"},nt={key:0,class:"text-center text-sm text-gray-500 py-4"},it={class:"space-y-3"},dt=["onUpdate:modelValue"],ut=["onUpdate:modelValue"],ct=["onClick"],mt={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},gt={class:"text-sm text-red-600 font-medium"},pt={class:"flex justify-end gap-4 p-6 border-t border-gray-200"},bt=["disabled"],ft=["disabled"],xt=S({__name:"EditProductModal",props:{isVisible:{type:Boolean},productData:{}},emits:["close","productUpdated"],setup(N,{emit:T}){const i=N,w=T,f=()=>({namaProduk:"",deskripsi:"",stok:0,hargaUnit:0,ukurans:[]}),t=O(f()),p=b(null),B=b(null),y=b(null),k=b(null),s=b(!1),o=b(null);q(()=>i.productData,a=>{a?(console.log("üì¶ Loading product data:",a),t.namaProduk=a.namaProduk,t.deskripsi=a.deskripsi||"",t.stok=a.stok,t.hargaUnit=a.hargaUnit,t.ukurans=(a.ukurans||[]).map(r=>({namaUkuran:r.namaUkuran,hargaTambahan:r.hargaTambahan})),y.value=a.foto||null,console.log("‚úÖ Form data loaded:",{...t,ukurans:t.ukurans})):l()});const n=()=>{t.ukurans.push({namaUkuran:"",hargaTambahan:0}),console.log("‚ûï Ukuran added. Total:",t.ukurans.length)},P=a=>{t.ukurans.splice(a,1),console.log("‚ûñ Ukuran removed. Total:",t.ukurans.length)},C=()=>{k.value?.click()},U=a=>{const r=a.target;r.src="https://placehold.co/96x96/eee/ccc?text=No+Image"},$=a=>{const r=a.target;if(r.files&&r.files[0]){const d=r.files[0];if(console.log("üì∑ New image selected:",d.name,`(${(d.size/1024).toFixed(2)} KB)`),!["image/jpeg","image/png","image/webp"].includes(d.type)){o.value="Format file tidak didukung. Gunakan JPG, PNG, atau WEBP.",console.error("‚ùå Invalid file type:",d.type);return}if(d.size>2*1024*1024){o.value="Ukuran file terlalu besar. Maksimal 2MB.",console.error("‚ùå File too large:",(d.size/1024/1024).toFixed(2),"MB");return}p.value=d;const h=new FileReader;h.onload=x=>{B.value=x.target?.result,console.log("‚úÖ Image preview created")},h.readAsDataURL(d),o.value=null}},V=async()=>{if(console.log(`
=================================`),console.log("üöÄ SUBMIT UPDATE PRODUCT"),console.log("================================="),!i.productData?.produkId){o.value="ID Produk tidak ditemukan.",console.error("‚ùå Product ID not found");return}if(!t.namaProduk||t.namaProduk.trim()===""){o.value="Nama produk wajib diisi.",console.error("‚ùå Product name is empty");return}if(t.hargaUnit<=0){o.value="Harga unit harus lebih dari 0.",console.error("‚ùå Invalid price:",t.hargaUnit);return}if(t.ukurans.length===0){o.value="Minimal harus ada 1 varian ukuran.",console.error("‚ùå No size variants");return}for(let a=0;a<t.ukurans.length;a++){const r=t.ukurans[a];if(!r.namaUkuran||r.namaUkuran.trim()===""){o.value=`Nama ukuran ke-${a+1} tidak boleh kosong.`,console.error("‚ùå Empty size name at index:",a);return}}s.value=!0,o.value=null;try{console.log("üìã Product ID:",i.productData.produkId),console.log("üìã Form Data:",{namaProduk:t.namaProduk,deskripsi:t.deskripsi,stok:t.stok,hargaUnit:t.hargaUnit,ukuransCount:t.ukurans.length}),console.log("üìã Has new photo:",!!p.value);const a=new FormData;a.append("namaProduk",t.namaProduk.trim()),a.append("deskripsi",t.deskripsi.trim()),a.append("stok",t.stok.toString()),a.append("hargaUnit",t.hargaUnit.toString()),p.value?(a.append("foto",p.value),console.log("üì∑ Attaching new photo:",p.value.name)):console.log("üì∑ No new photo, keeping existing");const r=t.ukurans.map(h=>({namaUkuran:h.namaUkuran.trim(),hargaTambahan:Number(h.hargaTambahan)||0}));console.log("üè∑Ô∏è Cleaned ukurans:",r);const d=JSON.stringify(r);a.append("ukuran",d),console.log("üì¶ ukuran JSON:",d),console.log(`
üì§ FormData being sent:`);for(const[h,x]of a.entries())x instanceof File?console.log(`  ${h}: [File] ${x.name} (${(x.size/1024).toFixed(2)} KB)`):console.log(`  ${h}:`,x);console.log(`
üåê Calling API: PUT /api/products/`+i.productData.produkId);const _=await Z(i.productData.produkId,a);console.log("‚úÖ API Response:",_),console.log("‚úÖ Product updated successfully!"),console.log(`=================================
`),w("productUpdated"),I()}catch(a){console.error(`
=================================`),console.error("‚ùå ERROR UPDATING PRODUCT"),console.error("================================="),console.error("Error object:",a),a.response?(console.error("Response status:",a.response.status),console.error("Response data:",a.response.data),console.error("Response headers:",a.response.headers)):a.request?console.error("No response received:",a.request):console.error("Error message:",a.message),console.error(`=================================
`),a.response?.data?.message?o.value=a.response.data.message:a.response?.data?.error?o.value=`Error: ${a.response.data.error}`:typeof a.response?.data=="string"?o.value=a.response.data:a.message?o.value=a.message:o.value="Terjadi kesalahan yang tidak diketahui. Silakan coba lagi."}finally{s.value=!1}},I=()=>{if(s.value){console.log("‚è≥ Cannot close while submitting");return}console.log("üö™ Closing modal"),l(),w("close")},g=()=>{I()},l=()=>{console.log("üîÑ Resetting form"),Object.assign(t,f()),t.ukurans=[],p.value=null,B.value=null,y.value=null,o.value=null,k.value&&(k.value.value="")};return(a,r)=>a.isVisible?(u(),c("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",style:{"background-color":"rgba(0, 0, 0, 0.7)"},onClick:g},[e("div",{class:"bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-4",onClick:r[4]||(r[4]=R(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between p-6 border-b border-gray-200"},[r[6]||(r[6]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Edit Produk",-1)),e("button",{onClick:I,class:"text-gray-400 hover:text-gray-600 transition-colors"},[...r[5]||(r[5]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("form",{onSubmit:R(V,["prevent"])},[e("div",et,[e("div",null,[r[7]||(r[7]=e("label",{for:"editNamaProduk",class:"block text-sm font-medium text-gray-700 mb-2"}," NAMA PRODUK ",-1)),D(e("input",{id:"editNamaProduk","onUpdate:modelValue":r[0]||(r[0]=d=>t.namaProduk=d),type:"text",required:"",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"},null,512),[[M,t.namaProduk]])]),e("div",null,[r[8]||(r[8]=e("label",{for:"editDeskripsi",class:"block text-sm font-medium text-gray-700 mb-2"}," DESKRIPSI ",-1)),D(e("textarea",{id:"editDeskripsi","onUpdate:modelValue":r[1]||(r[1]=d=>t.deskripsi=d),rows:"3",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors resize-none"},null,512),[[M,t.deskripsi]])]),e("div",tt,[e("div",null,[r[9]||(r[9]=e("label",{for:"editStok",class:"block text-sm font-medium text-gray-700 mb-2"}," STOK ",-1)),D(e("input",{id:"editStok","onUpdate:modelValue":r[2]||(r[2]=d=>t.stok=d),type:"number",required:"",min:"0",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"},null,512),[[M,t.stok,void 0,{number:!0}]])]),e("div",null,[r[10]||(r[10]=e("label",{for:"editHargaUnit",class:"block text-sm font-medium text-gray-700 mb-2"}," HARGA UNIT (Rp) ",-1)),D(e("input",{id:"editHargaUnit","onUpdate:modelValue":r[3]||(r[3]=d=>t.hargaUnit=d),type:"number",required:"",min:"0",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"},null,512),[[M,t.hargaUnit,void 0,{number:!0}]])])]),e("div",null,[r[12]||(r[12]=e("label",{for:"editImage",class:"block text-sm font-medium text-gray-700 mb-2"}," GAMBAR PRODUK (Opsional) ",-1)),e("div",ot,[e("div",at,[e("img",{src:B.value||y.value||"https://placehold.co/96x96/eee/ccc?text=No+Image",alt:"Preview",class:"w-24 h-24 object-cover rounded-lg border border-gray-200",onError:U},null,40,st)]),e("div",rt,[e("input",{id:"editImage",ref_key:"fileInput",ref:k,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:$,class:"hidden"},null,544),e("button",{type:"button",onClick:C,class:"px-4 py-2 border border-gray-300 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 focus:ring-2 focus:ring-[#BAB772] focus:border-transparent transition-colors"}," Ganti Gambar "),r[11]||(r[11]=e("p",{class:"text-xs text-gray-500 mt-1"},"Biarkan kosong jika tidak ingin mengganti gambar.",-1)),p.value?(u(),c("p",lt," File baru: "+v(p.value.name),1)):A("",!0)])])]),e("div",null,[r[13]||(r[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," VARIAN UKURAN ",-1)),t.ukurans.length===0?(u(),c("div",nt," Belum ada varian ukuran. ")):A("",!0),e("div",it,[(u(!0),c(j,null,E(t.ukurans,(d,_)=>(u(),c("div",{key:_,class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},[D(e("input",{"onUpdate:modelValue":h=>d.namaUkuran=h,type:"text",required:"",placeholder:"Nama (Cth: Large)",class:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-[#BAB772] focus:border-transparent"},null,8,dt),[[M,d.namaUkuran]]),D(e("input",{"onUpdate:modelValue":h=>d.hargaTambahan=h,type:"number",required:"",min:"0",placeholder:"Harga Tambahan (Rp)",class:"w-48 px-3 py-2 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-[#BAB772] focus:border-transparent"},null,8,ut),[[M,d.hargaTambahan,void 0,{number:!0}]]),e("button",{type:"button",onClick:h=>P(_),class:"text-red-500 hover:text-red-700 font-medium whitespace-nowrap",title:"Hapus Ukuran"}," Hapus ",8,ct)]))),128))]),e("button",{type:"button",onClick:n,class:"mt-3 px-4 py-2 border border-dashed border-[#BAB772] text-[#BAB772] rounded-lg text-sm font-medium hover:bg-[#FAFAD2] transition-colors w-full"}," + Tambah Varian Ukuran ")]),o.value?(u(),c("div",mt,[e("p",gt,v(o.value),1)])):A("",!0)]),e("div",pt,[e("button",{type:"button",onClick:I,disabled:s.value,class:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg font-medium hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"}," BATALKAN ",8,bt),e("button",{type:"submit",disabled:s.value,class:"px-6 py-3 bg-[#BAB772] text-white rounded-lg font-medium hover:bg-[#a8a668] disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},v(s.value?"Menyimpan...":"SIMPAN PERUBAHAN"),9,ft)])],32)])])):A("",!0)}}),vt={key:0,class:"bg-gray-50 rounded-lg p-4 mb-6"},kt={class:"flex items-center space-x-4"},yt=["src","alt"],ht={class:"flex-1"},wt={class:"font-medium text-gray-900"},Pt={class:"text-sm text-gray-600 mt-1"},At={key:1,class:"text-center mb-4 text-sm text-red-600"},Bt={class:"flex justify-end gap-4"},Ut=["disabled"],Ct=["disabled"],$t=S({__name:"DeleteConfirmModal",props:{isVisible:{type:Boolean},productData:{}},emits:["close","productDeleted"],setup(N,{emit:T}){const i=N,w=T,f=b(!1),t=b(null),p=z(()=>i.productData!==null),B=z(()=>{if(!i.productData)return"";const o=i.productData.deskripsi;return o.length>100?o.substring(0,100)+"...":o}),y=()=>{f.value||(t.value=null,w("close"))},k=()=>{f.value||y()},s=async()=>{if(!(!i.productData||f.value)){f.value=!0,t.value=null;try{await X(i.productData.produkId),w("productDeleted")}catch(o){console.error("Error deleting product:",o),t.value="Gagal menghapus produk. Coba lagi."}finally{f.value=!1}}};return(o,n)=>o.isVisible?(u(),c("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",style:{"background-color":"rgba(0, 0, 0, 0.7)"},onClick:k},[e("div",{class:"bg-white rounded-xl shadow-2xl w-full max-w-md mx-4 p-6",onClick:n[1]||(n[1]=R(()=>{},["stop"]))},[e("div",{class:"flex items-center justify-between mb-6"},[n[3]||(n[3]=e("h2",{class:"text-2xl font-bold text-gray-800"},"Hapus Produk",-1)),e("button",{onClick:y,class:"text-gray-400 hover:text-gray-600 transition-colors"},[...n[2]||(n[2]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),n[4]||(n[4]=Q('<div class="text-center mb-6"><div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4"><svg class="h-6 w-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg></div><h3 class="text-lg font-medium text-gray-900 mb-2">Konfirmasi Hapus</h3><p class="text-sm text-gray-500"> Apakah Anda yakin ingin menghapus produk ini? Tindakan ini tidak dapat dibatalkan. </p></div>',1)),p.value?(u(),c("div",vt,[e("div",kt,[e("img",{src:o.productData?.foto,alt:o.productData?.namaProduk,class:"w-16 h-16 object-cover rounded-lg border border-gray-200",onError:n[0]||(n[0]=P=>P.target.src="https://placehold.co/64x64/eee/ccc?text=Foto")},null,40,yt),e("div",ht,[e("h4",wt,v(o.productData?.namaProduk),1),e("p",Pt,v(B.value),1)])])])):A("",!0),t.value?(u(),c("div",At,v(t.value),1)):A("",!0),e("div",Bt,[e("button",{type:"button",onClick:y,disabled:f.value,class:"px-6 py-3 bg-gray-500 text-white rounded-lg font-medium hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"}," BATALKAN ",8,Ut),e("button",{type:"button",onClick:s,disabled:f.value,class:"px-6 py-3 bg-red-500 text-white rounded-lg font-medium hover:bg-red-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200"},v(f.value?"Menghapus...":"HAPUS"),9,Ct)])])])):A("",!0)}}),Dt={class:"p-8"},Mt={key:0,class:"bg-white rounded-xl shadow-lg p-6 overflow-x-auto"},Tt={class:"w-full"},Nt={class:"bg-gray-50 border-b border-gray-200"},It={key:2,class:"fixed inset-0 z-[60] flex items-center justify-center bg-transparent"},_t={key:3,class:"fixed bottom-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded shadow-lg z-[70]",role:"alert"},Vt={class:"block sm:inline"},St=S({name:"AdminKelolaProduct",__name:"KelolaProduct",setup(N,{expose:T}){const i=b(null),w=b([]),f=b(!0),t=b(null),p=b(1),B=b(10),y=b(0),k=b(1),s=b(!1),o=b(!1),n=b(!1),P=b(null),C=b(null),U=b(!1),$=async(x=p.value)=>{f.value=!0,t.value=null;try{p.value=x;const m=await te(x,B.value,!0);w.value=[...m.data.data],m.data.meta&&(y.value=m.data.meta.totalItems,k.value=m.data.meta.totalPages)}catch(m){console.error("Error loading product variants:",m),t.value="Gagal memuat data varian produk. Coba lagi nanti."}finally{f.value=!1}},V=x=>{x>=1&&x<=k.value&&$(x)},I=()=>{s.value=!0},g=async x=>{if(!x){console.error("ID Produk tidak valid."),t.value="Gagal memuat detail: ID tidak valid.";return}U.value=!0,t.value=null;try{const m=await L(x);P.value=m.data,o.value=!0}catch(m){console.error(`Gagal mengambil detail produk ${x}:`,m),t.value="Gagal memuat detail produk untuk diedit."}finally{U.value=!1}},l=async x=>{if(!x){console.error("ID Produk tidak valid."),t.value="Gagal memuat detail: ID tidak valid.";return}U.value=!0,t.value=null;try{const m=await L(x);C.value=m.data,n.value=!0}catch(m){console.error(`Gagal mengambil detail produk ${x} untuk dihapus:`,m),t.value="Gagal memuat detail produk untuk dihapus."}finally{U.value=!1}},a=async(x,m)=>{try{f.value=!0,await oe(x,m),await $(p.value)}catch(G){console.error(`Gagal mengubah status produk ${x}:`,G),t.value="Gagal mengubah status produk.",f.value=!1}},r=()=>s.value=!1,d=()=>{o.value=!1,P.value=null},_=()=>{n.value=!1,C.value=null},h=()=>{s.value=!1,o.value=!1,n.value=!1,P.value=null,C.value=null,$()};return Y(()=>{$()}),T({refreshAll:$}),(x,m)=>(u(),c("div",Dt,[f.value?(u(),c("div",Mt,[e("div",{class:"flex flex-col lg:flex-row lg:items-center lg:justify-between mb-6"},[m[2]||(m[2]=e("div",null,[e("h2",{class:"text-2xl font-bold text-gray-800"},"Kelola Produk & Varian"),e("p",{class:"text-gray-600 mt-1"},"Setiap baris mewakili satu varian produk")],-1)),e("button",{onClick:I,class:"mt-4 lg:mt-0 bg-[#BAB772] text-white px-6 py-3 rounded-lg font-medium hover:bg-[#a8a668] transition-colors duration-200 flex items-center gap-2"},[...m[1]||(m[1]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),F(" Tambah Produk ",-1)])])]),e("table",Tt,[e("thead",null,[e("tr",Nt,[(u(),c(j,null,E(9,G=>e("th",{key:G,class:"px-4 py-3 text-left text-sm font-medium text-gray-700"},[...m[3]||(m[3]=[e("div",{class:"h-4 bg-gray-200 rounded w-2/3"},null,-1)])])),64))])]),H(Fe)])])):(u(),ee(_e,{key:1,ref_key:"productTableRef",ref:i,"product-variants":w.value,"is-loading":f.value,"error-message":t.value,"current-page":p.value,"total-pages":k.value,"total-items":y.value,onAddProduct:I,onEditProduct:g,onDeleteProduct:l,onRefreshDataFromApi:$,onChangePage:V,onToggleStatus:a},null,8,["product-variants","is-loading","error-message","current-page","total-pages","total-items"])),H(Ye,{"is-visible":s.value,onClose:r,onProductAdded:h},null,8,["is-visible"]),H(xt,{"is-visible":o.value,"product-data":P.value,onClose:d,onProductUpdated:h},null,8,["is-visible","product-data"]),H($t,{"is-visible":n.value,"product-data":C.value,onClose:_,onProductDeleted:h},null,8,["is-visible","product-data"]),U.value?(u(),c("div",It,[...m[4]||(m[4]=[e("svg",{class:"h-10 w-10 text-white animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):A("",!0),t.value?(u(),c("div",_t,[m[6]||(m[6]=e("strong",{class:"font-bold"},"Error!",-1)),e("span",Vt,v(t.value),1),e("span",{class:"absolute top-0 bottom-0 right-0 px-4 py-3",onClick:m[0]||(m[0]=G=>t.value=null)},[...m[5]||(m[5]=[e("svg",{class:"fill-current h-6 w-6 text-red-500",role:"button",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20"},[e("title",null,"Close"),e("path",{d:"M14.348 14.849a1.2 1.2 0 0 1-1.697 0L10 11.819l-2.651 3.03a1.2 1.2 0 1 1-1.697-1.697l2.758-3.15-2.759-3.152a1.2 1.2 0 1 1 1.697-1.697L10 8.183l2.651-3.031a1.2 1.2 0 1 1 1.697 1.697l-2.758 3.152 2.758 3.15a1.2 1.2 0 0 1 0 1.698z"})],-1)])])])):A("",!0)]))}});export{St as default};
